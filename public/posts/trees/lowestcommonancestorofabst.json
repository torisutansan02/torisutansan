{
  "id": "trees/lowestcommonancestorofabst",
  "contentHtml": "<h1>Lowest Common Ancestor of a BST</h1>\n<p>You are given a <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>B</mi><mi>S</mi><mi>T</mi></mrow><annotation>BST</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">BST</span></span></span></span> <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow><annotation>root</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">roo</span><span class=\"mord mathnormal\">t</span></span></span></span> and must return the lowest common ancestor <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>(</mo><mi>L</mi><mi>C</mi><mi>A</mi><mo>)</mo></mrow><annotation>(LCA)</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">C</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span> of <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>p</mi></mrow><annotation>p</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">p</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>q</mi></mrow><annotation>q</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">q</span></span></span></span>, which represent nodes in the tree.</p>\n<ul>\n<li>The <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow><annotation>ancestor</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">ces</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">or</span></span></span></span> is a node who has both <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>p</mi></mrow><annotation>p</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">p</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>q</mi></mrow><annotation>q</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">q</span></span></span></span> as descendents.</li>\n</ul>\n<p><img src=\"/lowestCommonAncestorOfABST/LowestCommonAncestorOfABST1.png\" alt=\"Image\"></p>\n<h2>How to Solve?</h2>\n<p>This problem is relatively easy given it's a binary search tree. Notice how the nodes on the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><annotation>left</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">f</span><span class=\"mord mathnormal\">t</span></span></span></span> are smaller than the nodes on the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation>right</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">g</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">t</span></span></span></span>, does this hint at something?</p>\n<h3>Tree</h3>\n<p>Well, that intuition basically leads us to the solution.</p>\n<p>What if we set a current pointer to the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow><annotation>root</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">roo</span><span class=\"mord mathnormal\">t</span></span></span></span>, what should we evaluate?</p>\n<p>Is the current pointer <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>g</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow><annotation>greater</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">g</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">er</span></span></span></span> than the value of both the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>p</mi></mrow><annotation>p</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">p</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>q</mi></mrow><annotation>q</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">q</span></span></span></span> nodes?</p>\n<ul>\n<li>What do you think we should do?\n<ul>\n<li>Obviously, we should traverse left. Since the left values are smaller than the right values.</li>\n</ul>\n</li>\n</ul>\n<p>Is the current pointer <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>l</mi><mi>e</mi><mi>s</mi><mi>s</mi></mrow><annotation>less</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">l</span><span class=\"mord mathnormal\">ess</span></span></span></span> than the value of both the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>p</mi></mrow><annotation>p</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">p</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>q</mi></mrow><annotation>q</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">q</span></span></span></span> nodes?</p>\n<ul>\n<li>Obviously, we should search to the right.</li>\n</ul>\n<p>If we picked <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn></mrow><annotation>p = 2</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\"></span><span class=\"mrel\">=</span><span class=\"mspace\"></span></span><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">2</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>q</mi><mo>=</mo><mn>4</mn></mrow><annotation>q = 4</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">q</span><span class=\"mspace\"></span><span class=\"mrel\">=</span><span class=\"mspace\"></span></span><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">4</span></span></span></span>, and the current pointer is at <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>5</mn></mrow><annotation>5</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">5</span></span></span></span>, this means that the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>o</mi><mi>r</mi></mrow><annotation>ancestor</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">an</span><span class=\"mord mathnormal\">ces</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">or</span></span></span></span> is at least in the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi></mrow><annotation>left</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">f</span><span class=\"mord mathnormal\">t</span></span></span></span> subtree.</p>\n<p>So now current pointer is <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>1</mn></mrow><annotation>1</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">1</span></span></span></span> if we traverse left. Now notice how <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn></mrow><annotation>p = 2</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\"></span><span class=\"mrel\">=</span><span class=\"mspace\"></span></span><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">2</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>q</mi><mo>=</mo><mn>4</mn></mrow><annotation>q = 4</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">q</span><span class=\"mspace\"></span><span class=\"mrel\">=</span><span class=\"mspace\"></span></span><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">4</span></span></span></span>, but the current pointer is less than both.</p>\n<ul>\n<li>What should we do?\n<ul>\n<li>Traverse right.</li>\n</ul>\n</li>\n</ul>\n<p>The current pointer is at <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>3</mn></mrow><annotation>3</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">3</span></span></span></span>, and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn></mrow><annotation>p = 2</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\"></span><span class=\"mrel\">=</span><span class=\"mspace\"></span></span><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">2</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>q</mi><mo>=</mo><mn>4</mn></mrow><annotation>q = 4</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">q</span><span class=\"mspace\"></span><span class=\"mrel\">=</span><span class=\"mspace\"></span></span><span class=\"base\"><span class=\"strut\"></span><span class=\"mord\">4</span></span></span></span> now. But notice how <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>c</mi><mi>u</mi><mi>r</mi><mo>></mo><mi>p</mi></mrow><annotation>cur > p</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">r</span><span class=\"mspace\"></span><span class=\"mrel\">></span><span class=\"mspace\"></span></span><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">p</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>c</mi><mi>u</mi><mi>r</mi><mo>&#x3C;</mo><mi>q</mi></mrow><annotation>cur &#x3C; q</annotation></semantics></math></span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">r</span><span class=\"mspace\"></span><span class=\"mrel\">&#x3C;</span><span class=\"mspace\"></span></span><span class=\"base\"><span class=\"strut\"></span><span class=\"mord mathnormal\">q</span></span></span></span>, what should we do?</p>\n<ul>\n<li>I think we found an ancestor. It's lowest ancestor.</li>\n</ul>\n<p>This is the intuition behind the algorithm. Try using the logic to solve the problem yourself. If you need help, I have created an illustration below demonstrating the algorithm.</p>\n<p><img src=\"/lowestCommonAncestorOfABST/LowestCommonAncestorOfABST2.png\" alt=\"Image\"></p>\n<h3>Tree Solution</h3>\n<pre><code class=\"hljs language-python\"><span class=\"hljs-comment\"># Definition for a binary tree node.</span>\r\n<span class=\"hljs-comment\"># class TreeNode:</span>\r\n<span class=\"hljs-comment\">#     def __init__(self, x):</span>\r\n<span class=\"hljs-comment\">#         self.val = x</span>\r\n<span class=\"hljs-comment\">#         self.left = None</span>\r\n<span class=\"hljs-comment\">#         self.right = None</span>\r\n\r\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Solution</span>:\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">lowestCommonAncestor</span>(<span class=\"hljs-params\">self, root: <span class=\"hljs-string\">'TreeNode'</span>, p: <span class=\"hljs-string\">'TreeNode'</span>, q: <span class=\"hljs-string\">'TreeNode'</span></span>) -> <span class=\"hljs-string\">'TreeNode'</span>:\r\n        <span class=\"hljs-comment\"># Set cur to the root node</span>\r\n        cur = root\r\n\r\n        <span class=\"hljs-comment\"># Cur will find it's ancestor</span>\r\n        <span class=\"hljs-keyword\">while</span> cur:\r\n            <span class=\"hljs-comment\"># Check if cur's value is greater than p and q</span>\r\n            <span class=\"hljs-keyword\">if</span> cur.val > p.val <span class=\"hljs-keyword\">and</span> cur.val > q.val:\r\n                <span class=\"hljs-comment\"># Search left</span>\r\n                cur = cur.left\r\n            <span class=\"hljs-comment\"># Check if cur's value is less than p and q</span>\r\n            <span class=\"hljs-keyword\">elif</span> cur.val &#x3C; p.val <span class=\"hljs-keyword\">and</span> cur.val &#x3C; q.val:\r\n                <span class=\"hljs-comment\"># Search right</span>\r\n                cur = cur.right\r\n            <span class=\"hljs-comment\"># Else we found our lowest common ancestor</span>\r\n            <span class=\"hljs-keyword\">else</span>:\r\n                <span class=\"hljs-keyword\">return</span> cur\n</code></pre>",
  "title": "Lowest Common Ancestor of a BST",
  "date": "March 19, 2025",
  "category": "Trees",
  "categories": []
}